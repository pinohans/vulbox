<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<!-- Pingdom Real User Monitoring -->
	<script>
	var _prum = [['id', '56a14edeabe53deb7ff24334'],
	             ['mark', 'firstbyte', (new Date()).getTime()]];
	(function() {
	    var s = document.getElementsByTagName('script')[0]
	      , p = document.createElement('script');
	    p.async = 'async';
	    p.src = '//rum-static.pingdom.net/prum.min.js';
	    s.parentNode.insertBefore(p, s);
	})();
	</script>
	<!-- End Pingdom Real User Monitoring -->

	<title>CVE&#x2d;2021&#x2d;3156: Heap&#x2d;Based Buffer Overflow in Sudo (Baron Samedit) | Qualys Security Blog</title><style id="rocket-critical-css">:root{--wp-admin-theme-color:#007cba;--wp-admin-theme-color-darker-10:#006ba1;--wp-admin-theme-color-darker-20:#005a87}.wp-block-image img{max-width:100%}.wp-block-image.alignwide img{width:100%}@font-face{font-family:Gotham;font-style:normal;font-weight:300;src:local("Gotham Light"),local("Gotham-Light"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/gotham-light.woff2) format("woff2"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/gotham-light.woff) format("woff")}@font-face{font-family:Gotham;font-style:normal;font-weight:400;src:local("Gotham Book"),local("Gotham-Book"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/gotham-book.woff2) format("woff2"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/gotham-book.woff) format("woff")}@font-face{font-family:Gotham;font-style:normal;font-weight:500;src:local("Gotham Medium"),local("Gotham-Medium"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/gotham-medium.woff2) format("woff2"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/gotham-medium.woff) format("woff")}@font-face{font-family:Gotham;font-style:normal;font-weight:700;src:local("Gotham Bold"),local("Gotham-Bold"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/gotham-bold.woff2) format("woff2"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/gotham-bold.woff) format("woff")}@font-face{font-family:Caecilia;font-style:normal;font-weight:400;src:local("Caecilia LT Pro 55 Roman"),local("CaeciliaLTPro-55Roman"),local("PMN Caecilia Com 55 Roman"),local("CaeciliaCom-55Roman"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/caecilia-lt-pro-55-roman.woff2) format("woff2"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/caecilia-lt-pro-55-roman.woff) format("woff")}@font-face{font-family:Caecilia;font-style:normal;font-weight:700;src:local("Caecilia LT Pro 75 Bold"),local("CaeciliaLTPro-75Bold"),local("PMN Caecilia Com 75 Bold"),local("CaeciliaCom-75Bold"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/caecilia-lt-pro-75-bold.woff2) format("woff2"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/caecilia-lt-pro-75-bold.woff) format("woff")}@font-face{font-family:Caecilia;font-style:italic;font-weight:400;src:local("Caecilia LT Pro 56 Italic"),local("CaeciliaLTPro-56Italic"),local("PMN Caecilia Com 56 Italic"),local("CaeciliaCom-56Italic"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/caecilia-lt-pro-56-italic.woff2) format("woff2"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/caecilia-lt-pro-56-italic.woff) format("woff")}@font-face{font-family:Caecilia;font-style:italic;font-weight:700;src:local("Caecilia LT Pro 76 Bold Italic"),local("CaeciliaLTPro-76BoldItalic"),local("PMN Caecilia Com 76 Bold Italic"),local("CaeciliaCom-76BoldItalic"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/caecilia-lt-pro-76-bold-italic.woff2) format("woff2"),url(https://d1uyme8f6ss6qi.cloudfront.net/font/caecilia-lt-pro-76-bold-italic.woff) format("woff")}html{box-sizing:border-box;font-size:100%}*,*::before,*::after{box-sizing:inherit}body{background:white;color:#6A778B;font-family:Caecilia,sans-serif;font-size:1em;line-height:1.5}h1,h3{color:#262626;font-family:Gotham,sans-serif;font-weight:500;margin-top:1em;margin-bottom:1em}h1{font-size:2.5em;line-height:1.4;letter-spacing:calc(-0.92 / 40 * 1em)}h3{font-size:1.75em;letter-spacing:calc(-0.92 / 28 * 1em);line-height:1.4}a:link,a:visited{color:#2E8BE0;text-decoration:none}.hidden.hidden{display:none;visibility:hidden}.q-header__background{background:#EEEFF2;font-family:Gotham,sans-serif;height:82px;left:0;right:0;top:0;width:100%;z-index:99;position:absolute}.q-header__background,.q-header__background a:link,.q-header__background a:visited{color:#262626;text-decoration:none}.q-header__container{display:flex;justify-content:space-between;align-items:center;margin:0 2rem}.q-header__logo{align-items:center;display:flex;margin:23px 0 24px;max-height:57px}.q-header__logo .q-logo-shield{display:block;overflow:hidden;width:30px;height:35px}.q-header__logo .q-logo-text{display:block;margin-left:calc(1 / 3 * 1em)}.q-header__logo-community{font-weight:300;font-size:18px;line-height:1}.q-user-menu{height:40px;position:relative;width:40px}.q-hamberger-menu{width:40px;height:40px}.q-hamburger-menu__container{height:0;margin-top:2rem;min-width:calc(-2rem + 100vw + -2rem);opacity:0;overflow-x:hidden;overflow-y:scroll;transform:translate(0,-1rem);visibility:hidden}li.q-header_blog-link a{font-weight:500}.q-user-menu__icon,.q-hamburger-menu__icon{align-items:center;display:flex;height:40px;justify-content:center;opacity:1;overflow:hidden;transform:translate(0,0) rotate(0);width:40px}.q-user-menu__icon.hidden{opacity:0;transform:translate(0,0.25em)}.q-user-menu__icon{margin-right:calc(calc(40px - 19px) / 2 * -1)}.q-hamburger-menu__icon{margin-left:calc(calc(40px - 23px) / 2 * -1)}.q-hamburger-menu__icon rect:nth-child(2){opacity:1}.q-hamburger-menu__icon rect:nth-child(1),.q-hamburger-menu__icon rect:nth-child(3){transform:translate(0,0) rotate(0)}.q-header__nav,.q-header__nav ul{list-style:none;margin:0;padding:0}.q-header__nav a,.q-header__nav li>span{display:inline-block;padding:1rem 0;font-size:calc(18 / 16 * 1rem);font-weight:500;letter-spacing:-0.13px;line-height:1}.q-header__nav{position:relative;left:0;opacity:1}.q-header__nav-sub{left:100vw;min-width:100%;position:absolute;top:0}.q-header__nav li.q-browser-by-topic>span{font-size:calc(12 / 16 * 1rem);line-height:1.5;opacity:0.5;text-transform:uppercase}.q-header__nav-back{background:none;border:0 none;font-size:inherit;font-weight:inherit}.q-header__nav-back::before{content:"‚Üê";padding-right:0.5ex}.q-header__nav-sub li{list-style:none}.q-header__nav-sub li:last-child{margin-bottom:0}.q-header__nav-sub a{color:#30405B;font-size:calc(18 / 16 * 1rem);font-weight:500;letter-spacing:-0.17px}.q-button__light-blue a,.q-button__light-blue a:link,.q-button__light-blue a:visited{background:#6CA3CF;border-radius:2px;color:white;display:inline-block;font-family:Gotham,sans-serif;font-size:15px;font-weight:500;letter-spacing:-0.2px;padding:16px 25px 17px;text-align:center}.q-button__start-a-discussion a,.q-button__start-a-discussion a:link,.q-button__start-a-discussion a:visited{margin:24px 0;display:inline-block;position:relative}.q-header__nav-sub li.q-browser-by-topic a{display:none;padding-bottom:0}.q-header__nav-sub li.q-browser-by-topic span.menu-item-description{line-height:1.5;display:block}.q-main_content{margin:0 5%;padding-bottom:60px;padding-top:10px}@media screen and (min-width:841px){.q-main_content-container{display:flex}.site-main{flex:1}}.q-search__container{margin:calc(82px + 0.75em) 0 0;height:82px;max-width:1440px}.q-search{margin:0 5%}.q-search .q-coveo__wrapper{display:flex;visibility:visible}.q-search .q-coveo__wrapper .CoveoSearchButton,.q-search .q-coveo__wrapper .CoveoOmnibox{border:0 none;border-bottom:2px solid #2E8BE0}.q-search .q-coveo__wrapper .CoveoSearchButton{text-align:inherit;width:26px}.q-search .q-coveo-searchbutton{flex:0 1 auto}.q-search .q-coveo-querybox{flex:1 1 auto}@media screen and (max-width:374px){.q-header__nav-sub .q-button__start-a-discussion{display:none;visibility:hidden}}.q-post__entry-header{display:flex;margin-bottom:10px;align-items:center}.single-post .q-post__entry-header{margin-bottom:0;border-right:1px solid rgba(106,119,139,0.5);padding-right:25px}.q-post__entry-avatar{margin-right:10px}.q-post__entry-header .q-post__entry-avatar{width:54px;height:54px}.q-post__entry-avatar img{border-radius:50%;background:#F2F2F3;box-shadow:0 0 6px 0 rgba(0,0,0,0.15)}.q-post__entry-author a{text-decoration:none;font-family:Gotham,sans-serif;color:#2E8BE0;font-size:14px;font-weight:500;letter-spacing:-0.2px;line-height:1.5}.single-post .q-post__entry-author a{font-size:15px}.q-post__entry-author{font-family:Gotham,sans-serif;font-size:15px;line-height:1.5;font-weight:500;color:#6A778B}.q-post__entry-time{color:#6A778B;font-family:Gotham,sans-serif;font-size:14px;letter-spacing:-0.2px;line-height:1.5}.q-post__entry-time a{text-decoration:none;color:#6A778B}.likebutton{min-height:31px;display:block;margin-right:1em}.entry-content p{font-size:16px}.entry-content img{max-width:100%;height:auto}.q-blog__home-link a{font-family:Gotham,sans-serif;font-size:14px;color:#2E8BE0;letter-spacing:-0.2px;line-height:2.5;text-decoration:none;font-weight:500}.q-blog__home-link a span{display:inline-block}.q-blog__post-title{font-family:Gotham,sans-serif;font-size:32px;color:#262626;letter-spacing:-0.92px;line-height:1.159;font-weight:500;margin:0}.q-single__post-content,.single-post .q-blog__home-link-wrapper{max-width:720px;margin:0 auto}.q-post__entry-header-outerwrapper{display:flex;align-items:center;margin:25px 0 40px;justify-content:space-between}.q-post__entry-header-wrapper{display:flex;align-items:center}.q-menu__home-container ul.menu{margin:auto;padding:0;list-style:none}#comments{display:none}.comment-form label{min-width:5.2em;display:inline-block}.comment-form-comment label{vertical-align:top;padding-top:0.5em}.comment-form{font-family:Gotham,sans-serif;margin-bottom:3em}.comment-form input,.comment-form textarea{border:1px solid #ccc;padding:1.1em;color:#6A778B!important;line-height:1.4;width:100%;border-radius:2px}.comment-form textarea{resize:vertical}.comment-form [type="submit"]{min-width:auto;background:#F2F2F3;font-family:Gotham,sans-serif;color:#6A778B!important;border:0;padding:0.5em 1em}.comment-form-cookies-consent{display:flex}.comment-form #wp-comment-cookies-consent{height:16px;width:auto;margin-right:0.6em;margin-top:4px}.comment-form-comment label,.comment-form-author label,.comment-form-email label,.comment-form-cookies-consent,.comment-notes{display:none}#respond{width:91%;margin:0 auto}#comment{width:100%}.form-submit input{width:auto}p.form-submit{display:flex;justify-content:flex-end}#reply-title{margin-bottom:0}#reply-title small{font-size:14px;letter-spacing:0;font-weight:normal;margin:16px 0 0 6px;float:right}.comment-form p{margin-top:0.5em;margin-bottom:0.5em}.entry-content #jp-relatedposts h3.jp-relatedposts-headline em:before{display:none}.entry-content #jp-relatedposts.jp-relatedposts{padding-top:30px;border-top:1px solid rgba(0,0,0,0.15)}.entry-content #jp-relatedposts h3.jp-relatedposts-headline{border:0;font-family:"Gotham",sans-serif;font-weight:500;font-size:18px}.entry-content #jp-relatedposts h3.jp-relatedposts-headline em{font-weight:500}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}a{background-color:transparent}small{font-size:80%}img{border-style:none}input,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}input{overflow:visible}[type=submit]{-webkit-appearance:button}[type=submit]::-moz-focus-inner{border-style:none;padding:0}[type=submit]:-moz-focusring{outline:1px dotted ButtonText}textarea{overflow:auto}[type=checkbox]{box-sizing:border-box;padding:0}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}.alignwide img{box-shadow:0 2px 20px 0 rgba(0,0,0,0.25)}.updated:not(.published){display:none}.entry-content p{line-height:1.65;font-weight:400;color:#6A778B}.entry-content *{word-break:break-word}.CoveoSearchButton{color:white;border:1px solid #7e8c9a;border-left:none;text-decoration:none;text-align:center;vertical-align:middle;overflow:hidden;height:50px;width:60px;line-height:0}.CoveoSearchButton:before{content:'';vertical-align:middle;height:100%;display:inline-block}#jp-relatedposts{display:none;padding-top:1em;margin:1em 0;position:relative;clear:both}.jp-relatedposts:after{content:'';display:block;clear:both}#jp-relatedposts h3.jp-relatedposts-headline{margin:0 0 1em 0;display:inline-block;float:left;font-size:9pt;font-weight:700;font-family:inherit}#jp-relatedposts h3.jp-relatedposts-headline em:before{content:"";display:block;width:100%;min-width:30px;border-top:1px solid #ddd;border-top:1px solid rgba(0,0,0,.2);margin-bottom:1em}#jp-relatedposts h3.jp-relatedposts-headline em{font-style:normal;font-weight:700}</style>

<!-- The SEO Framework by Sybre Waaijer -->
<meta name="description" content="Update Feb 3, 2021: It has been reported that macOS, AIX, and Solaris are also vulnerable to CVE-2021-3156, and that others may also still be vulnerable." />
<meta property="og:image" content="https://blog.qualys.com/wp-content/uploads/2020/11/Qualys-Research-Security-Alert.png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="627" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="CVE&#x2d;2021&#x2d;3156: Heap&#x2d;Based Buffer Overflow in Sudo (Baron Samedit) | Qualys Security Blog" />
<meta property="og:description" content="Update Feb 3, 2021: It has been reported that macOS, AIX, and Solaris are also vulnerable to CVE-2021-3156, and that others may also still be vulnerable. Qualys has not independently verified the&#8230;" />
<meta property="og:url" content="https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit" />
<meta property="og:site_name" content="Qualys Security Blog" />
<meta property="article:publisher" content="https://www.facebook.com/qualys" />
<meta property="article:published_time" content="2021-01-26T18:09+00:00" />
<meta property="article:modified_time" content="2021-02-03T22:29+00:00" />
<meta property="og:updated_time" content="2021-02-03T22:29+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@qualys" />
<meta name="twitter:title" content="CVE&#x2d;2021&#x2d;3156: Heap&#x2d;Based Buffer Overflow in Sudo (Baron Samedit) | Qualys Security Blog" />
<meta name="twitter:description" content="Update Feb 3, 2021: It has been reported that macOS, AIX, and Solaris are also vulnerable to CVE-2021-3156, and that others may also still be vulnerable. Qualys has not independently verified the&#8230;" />
<meta name="twitter:image" content="https://blog.qualys.com/wp-content/uploads/2020/11/Qualys-Research-Security-Alert.png" />
<meta name="twitter:image:width" content="1200" />
<meta name="twitter:image:height" content="627" />
<link rel="canonical" href="https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit" />
<script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://blog.qualys.com/","name":"Qualys Security Blog"}},{"@type":"ListItem","position":2,"item":{"@id":"https://blog.qualys.com/category/vulnerabilities-research","name":"Vulnerabilities and Research"}},{"@type":"ListItem","position":3,"item":{"@id":"https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit","name":"CVE-2021-3156: Heap-Based Buffer Overflow in Sudo (Baron Samedit)"}}]}</script>
<!-- / The SEO Framework by Sybre Waaijer | 0.35ms meta | 0.54ms boot -->

<link rel='dns-prefetch' href='//cdnjs.cloudflare.com' />
<link rel='dns-prefetch' href='//static.cloud.coveo.com' />
<link rel='dns-prefetch' href='//797-eni-742.mktoresp.com' />
<link rel='dns-prefetch' href='//api.ipify.org' />
<link rel='dns-prefetch' href='//app-sj08.marketo.com' />
<link rel='dns-prefetch' href='//d1uyme8f6ss6qi.cloudfront.net' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//fonts.gstatic.com' />
<link rel='dns-prefetch' href='//geoip-js.com' />
<link rel='dns-prefetch' href='//js.maxmind.com' />
<link rel='dns-prefetch' href='//munchkin.marketo.net' />
<link rel='dns-prefetch' href='//pixel.wp.com' />
<link rel='dns-prefetch' href='//rum-collector-2.pingdom.net' />
<link rel='dns-prefetch' href='//rum-static.pingdom.net' />
<link rel='dns-prefetch' href='//stats.g.doubleclick.net' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//www.google-analytics.com' />
<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//www.googletagmanager.com' />
<link rel='dns-prefetch' href='//0.gravatar.com' />
<link rel='dns-prefetch' href='//2.gravatar.com' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link href='https://fonts.gstatic.com' crossorigin rel='preconnect' />
<link rel="alternate" type="application/rss+xml" title="Qualys Security Blog &raquo; Feed" href="https://blog.qualys.com/feed" />
<link rel="alternate" type="application/rss+xml" title="Qualys Security Blog &raquo; Comments Feed" href="https://blog.qualys.com/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="Qualys Security Blog &raquo; CVE-2021-3156: Heap-Based Buffer Overflow in Sudo (Baron Samedit) Comments Feed" href="https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit/feed" />
<link rel='preload'   href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-includes/css/dist/block-library/style.min.css?ver=5.5.3' data-rocket-async="style" as="style" onload="this.onload=null;this.rel='stylesheet'" media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify{text-align:justify;}
</style>
<link data-minify="1" rel='preload'   href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/plugins/ajax-load-more-filters/dist/css/styles-97153ac796d733e4a046254ad8a00073.css' data-rocket-async="style" as="style" onload="this.onload=null;this.rel='stylesheet'" media='all' />
<link rel='preload'   href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/plugins/ajax-load-more/core/dist/css/ajax-load-more.min.css?ver=5.5.3' data-rocket-async="style" as="style" onload="this.onload=null;this.rel='stylesheet'" media='all' />
<link data-minify="1" rel='preload'   href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/plugins/progressive-wp/assets/styles/ui-pushbutton-3fc78fcdb4089ce6e2c6d3df8fde3813.css' data-rocket-async="style" as="style" onload="this.onload=null;this.rel='stylesheet'" media='all' />
<link data-minify="1" rel='preload'   href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/themes/qualys2020/style/shared-60718d88b10e4f3ce4fb7deefd7f9fa0.css' data-rocket-async="style" as="style" onload="this.onload=null;this.rel='stylesheet'" media='all' />
<link data-minify="1" rel='preload'   href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/themes/qualys2020/style/shared-min-30em-4b6edaa9ccd65f8f6f3fe4625134eefb.css' data-rocket-async="style" as="style" onload="this.onload=null;this.rel='stylesheet'" media='screen and (min-width: 30em)' />
<link data-minify="1" rel='preload'   href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/themes/qualys2020/style/shared-min-60em-e7f7c2aa75fa2713e852d371cd314885.css' data-rocket-async="style" as="style" onload="this.onload=null;this.rel='stylesheet'" media='screen and (min-width: 60em)' />
<link data-minify="1" rel='preload'   href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/themes/qualys2020/style-01aae4306ae3572dc3ef43c461d72821.css' data-rocket-async="style" as="style" onload="this.onload=null;this.rel='stylesheet'" media='all' />
<link rel='preload'   href='https://static.cloud.coveo.com/searchui/v2.9856/css/CoveoFullSearch.css?ver=5.5.3' data-rocket-async="style" as="style" onload="this.onload=null;this.rel='stylesheet'" media='all' />
<link data-minify="1" rel='preload'   href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/plugins/jetpack/css/jetpack-e4000e16d6eed41b6ec39e8396515003.css' data-rocket-async="style" as="style" onload="this.onload=null;this.rel='stylesheet'" media='all' />
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js' id='jquery-js'></script>
<script id='jetpack_related-posts-js-extra'>
var related_posts_js_options = {"post_heading":"h4"};
</script>
<script src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/plugins/jetpack/_inc/build/related-posts/related-posts.min.js?ver=20201207' id='jetpack_related-posts-js'></script>
<link rel="https://api.w.org/" href="https://blog.qualys.com/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.qualys.com/wp-json/wp/v2/posts/27395" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.qualys.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.qualys.com/wp-includes/wlwmanifest.xml" /> 
<link rel="alternate" type="application/json+oembed" href="https://blog.qualys.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.qualys.com%2Fvulnerabilities-research%2F2021%2F01%2F26%2Fcve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit" />
<link rel="alternate" type="text/xml+oembed" href="https://blog.qualys.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.qualys.com%2Fvulnerabilities-research%2F2021%2F01%2F26%2Fcve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit&#038;format=xml" />
<script type='text/javascript'>var PwpJsVars = {"AjaxURL":"https:\/\/blog.qualys.com\/wp-admin\/admin-ajax.php","homeurl":"https:\/\/blog.qualys.com\/","installprompt":{"mode":"normal","pageloads":"2","onclick":""},"message_pushremove_failed":"Device could not be removed.","message_pushadd_failed":"Device could not be registered."};</script>		<script type="text/javascript" id="serviceworker-unregister">
			if ('serviceWorker' in navigator) {
				navigator.serviceWorker.getRegistrations().then(function (registrations) {
					registrations.forEach(function (registration) {
						if (registration.active.scriptURL === window.location.origin + '/pwp-serviceworker.js') {
							registration.unregister();
						}
					});
				});
			}
		</script>
				<script type="text/javascript" id="serviceworker">
			if (navigator.serviceWorker) {
				window.addEventListener('load', function () {
					navigator.serviceWorker.register(
						"https:\/\/blog.qualys.com\/?wp_service_worker=1", {"scope": "\/"}
					);
				});
			}
		</script>
		<link rel="manifest" href="https://blog.qualys.com/wp-json/app/v1/pwp-manifest"><meta name="theme-color" content="#2c75be"><style type='text/css'>img#wpstats{display:none}</style>			<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
			<script>
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
		<link rel="icon" href="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/cropped-qualys-150x150.png" sizes="32x32" />
<link rel="icon" href="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/cropped-qualys-300x300.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/cropped-qualys-300x300.png" />
<meta name="msapplication-TileImage" content="https://blog.qualys.com/wp-content/uploads/2017/07/cropped-qualys-300x300.png" />
<script>
/*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */
(function(w){"use strict";if(!w.loadCSS){w.loadCSS=function(){}}
var rp=loadCSS.relpreload={};rp.support=(function(){var ret;try{ret=w.document.createElement("link").relList.supports("preload")}catch(e){ret=!1}
return function(){return ret}})();rp.bindMediaToggle=function(link){var finalMedia=link.media||"all";function enableStylesheet(){link.media=finalMedia}
if(link.addEventListener){link.addEventListener("load",enableStylesheet)}else if(link.attachEvent){link.attachEvent("onload",enableStylesheet)}
setTimeout(function(){link.rel="stylesheet";link.media="only x"});setTimeout(enableStylesheet,3000)};rp.poly=function(){if(rp.support()){return}
var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"&&!link.getAttribute("data-loadcss")){link.setAttribute("data-loadcss",!0);rp.bindMediaToggle(link)}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,500);if(w.addEventListener){w.addEventListener("load",function(){rp.poly();w.clearInterval(run)})}else if(w.attachEvent){w.attachEvent("onload",function(){rp.poly();w.clearInterval(run)})}}
if(typeof exports!=="undefined"){exports.loadCSS=loadCSS}
else{w.loadCSS=loadCSS}}(typeof global!=="undefined"?global:this))
</script>
	<!-- Google Tag Manager -->
	<script>
		if (!window.location.search.match(/[?&;]dnt=1([;&]|$)/)) {

			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-W7DWPS');

		}
	</script>
	<!-- End Google Tag Manager -->

</head>

<body class="post-template-default single single-post postid-27395 single-format-standard">

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W7DWPS"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W7DWPS"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->

	
<div class="q-header__background">
	<header class="q-header site-header" id="masthead">
		<div class="q-header__container">
			<div class="q-hamberger-menu">
				<div class="q-hamburger-menu__icon">
					<svg width="23" height="23" viewBox="0 0 23 23" version="1.1" xmlns="http://www.w3.org/2000/svg">
						<g fill="currentColor">
							<rect id="Rectangle1" x="0" y="5" width="23" height="3" rx="1.5"></rect>
							<rect id="Rectangle2" x="0" y="10" width="23" height="3" rx="1.5"></rect>
							<rect id="Rectangle3" x="0" y="15" width="23" height="3" rx="1.5"></rect>
						</g>
					</svg>
				</div>
				<div class="q-hamburger-menu__container">
					<ul id="primary-menu" class="q-header__nav"><li id="menu-item-26462" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-26462 q-navigation__item"><a href="https://qualys-secure.force.com/discussions/s/">Discussions</a>
<ul class="sub-menu q-header__nav-sub">
	<li id="menu-item-26463" class="q-header__nav-back menu-item menu-item-type-custom menu-item-object-custom menu-item-26463 q-navigation__item"><a href="#back">Back to main menu</a></li>
	<li id="menu-item-26464" class="q-browser-by-topic menu-item menu-item-type-custom menu-item-object-custom menu-item-26464 q-navigation__item"><a href="https://qualys-secure.force.com/discussions/s/">BROWSE BY TOPIC</a><span class="menu-item-description">BROWSE BY TOPIC</span></li>
	<li id="menu-item-26465" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26465 q-navigation__item"><a href="https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIRIWA4/asset-management">Global IT Asset Management</a></li>
	<li id="menu-item-26466" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26466 q-navigation__item"><a href="https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIRwWAO/it-security">IT Security</a></li>
	<li id="menu-item-26467" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26467 q-navigation__item"><a href="https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIS1WAO/compliance">Compliance</a></li>
	<li id="menu-item-26468" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26468 q-navigation__item"><a href="https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIRnWAO/cloud-container">Cloud &#038; Container Security</a></li>
	<li id="menu-item-26469" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26469 q-navigation__item"><a href="https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HISCWA4/web-app-security">Web App Security</a></li>
	<li id="menu-item-26470" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26470 q-navigation__item"><a href="https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIRfWAO/certificate-security">Certificate Security &#038; SSL Labs</a></li>
	<li id="menu-item-26471" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26471 q-navigation__item"><a href="https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIR8WAO/developer">Developer API</a></li>
	<li id="menu-item-26562" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26562 q-navigation__item"><a href="https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIRAWA4/qualys-cloud-platform">Cloud Platform</a></li>
	<li id="menu-item-26472" class="q-button__start-a-discussion q-button__light-blue q-button-with-arrow menu-item menu-item-type-custom menu-item-object-custom menu-item-26472 q-navigation__item"><a href="https://qualys-secure.force.com/discussions/s/#start-a-discussion">Start a discussion</a></li>
</ul>
</li>
<li id="menu-item-26473" class="q-header_blog-link menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-26473 q-navigation__item"><a href="https://blog.qualys.com/">Blog</a></li>
<li id="menu-item-26474" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26474 q-navigation__item"><a href="https://www.qualys.com/training/">Training</a></li>
<li id="menu-item-26475" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26475 q-navigation__item"><a href="https://www.qualys.com/documentation/">Docs</a></li>
<li id="menu-item-26476" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26476 q-navigation__item"><a href="https://qualys-secure.force.com/customer/s/">Support</a></li>
<li class="q-header__nav-underline"></li></ul>				</div>
			</div>
			<a class="q-header__logo q-header__logo-community" href="https://community.qualys.com/" title="Qualys Community">
				<span class="q-logo-shield">
					<svg  width="111" height="35" alt="Qualys" class="q-logo__horizontal" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 933.884 293.111"><path d="M123.073 0c80.158 0 120.462 42.888 120.462 42.888s4.608 31.746 1.667 95.667c-4.443 96.56-122.1 154.55-122.111 154.556s-117.666-57.996-122.11-154.556c-2.941-63.921 1.667-95.667 1.667-95.667s40.268-42.888 120.425-42.888z" fill="#ed2e26"/><path d="M394.178 75.824a70.586 70.586 0 0 0-70.506 70.506c0 23.533 9.89 44.5 28.6 60.641 17.522 15.113 42.649 25.532 71.66 30.36 4.149-2.279 11.994-9.969 14.492-15.236-21.375-3.687-31.178-7.346-31.178-7.346a40.676 40.676 0 0 0 8.23-1.652c28.556-8.009 49.489-36.214 49.208-66.766-.357-38.876-31.628-70.507-70.506-70.507zm0 120.714a50.208 50.208 0 1 1 50.209-50.208 50.265 50.265 0 0 1-50.209 50.208zM915.488 189.828a11.292 11.292 0 0 1 15.377 0 11.587 11.587 0 0 1 0 15.6 11.3 11.3 0 0 1-15.377 0 11.587 11.587 0 0 1 0-15.6zm1.556 14.095a8.969 8.969 0 0 0 12.264 0 9.539 9.539 0 0 0 0-12.609 9.025 9.025 0 0 0-12.264 0 9.544 9.544 0 0 0 0 12.609zm10.708-9.106a3.558 3.558 0 0 1-2.654 3.568l3.066 4.806h-2.381l-2.791-4.668h-1.418v4.668h-2.014v-11.9h4.393a3.924 3.924 0 0 1 2.747.963 3.3 3.3 0 0 1 1.052 2.562zm-6.178-1.65v3.479h2.106a2.06 2.06 0 0 0 1.44-.481 1.622 1.622 0 0 0 .526-1.258q0-1.738-1.966-1.739zM784.087 178.724l-23.814-63.187h-21.219l34.746 88.2s-15.371 36.539-15.365 36.536c10.113 0 21.176-.714 25.5-11.37 10.152-24.993 45.505-113.365 45.505-113.365h-21.221zM704.493 210.246s19.7-.365 19.7-13.729v-120.033h-19.7zM663.646 127.976c-5.485-7.649-16.2-15.073-31.971-15.073-26.92 0-47.221 20.937-47.221 48.7 0 12.977 4.437 25.036 12.494 33.955 8.715 9.649 20.724 14.748 34.727 14.748 13.567 0 25.184-5.534 31.971-15.014v14.951s19.7-.312 19.7-13.719v-80.99h-19.7zm-29.5 63.789c-11.908 0-29.72-7.947-30-29.839v-.157c0-17.288 12.754-30.325 29.666-30.325 12.633 0 22.9 6.6 27.487 17.711a27.268 27.268 0 0 1 2.509 12.733 32.62 32.62 0 0 1-3.023 12.869c-4.633 10.65-14.595 17.008-26.641 17.008zM548.568 166.874c0 15.9-8.26 24.745-23.244 24.891-15.2 0-22.587-8.627-22.587-26.373v-49.855h-19.695v53.806c0 7.767 1.309 18.842 7.548 27.506 6.375 8.854 16.452 13.382 29.945 13.459h.553c16.138 0 24.448-7.315 28.468-13v12.934s18.707-.319 18.707-13.062v-81.643h-19.7zM876.661 152.965c-10.235-4.424-17.676-8.25-17.545-14.185.087-3.927 5.259-7.687 10.637-7.5 5.756.2 10.023 4.168 12.4 7.344 0 0 10.76-9.2 12.062-10.183a30.164 30.164 0 0 0-25.661-14.657 27.317 27.317 0 0 0-28.054 26.48c-.285 12.937 7.292 18.276 17.23 23.913l16.357 9.2c3.774 2.639 5.554 4.609 5.464 8.669-.14 6.362-5.461 10.486-12.352 10.893-5.069.3-9.232-2.631-13.176-6.759-7.677-8.034-19.46-4.172-23.065-3.01 7.5 17.24 21.68 27.279 35.849 27.591 17.844.393 32.118-12.777 32.5-29.983.174-8.286-3.456-18.578-22.646-27.813z" fill="#262626"/><path d="M62.924 126.929c0-34.142 26.991-61.918 60.167-61.918a60.285 60.285 0 0 1 60.217 60.217c0 26.507-22.786 48.316-40.348 59.523 6.813 3.887 21.849 7.969 36.245 9.289a86.906 86.906 0 0 0 33.843-68.811 89.957 89.957 0 1 0-179.913 0c0 29.958 12.474 56.571 36.072 76.964 22.063 19.065 54.336 31.791 91.081 37.816 7.96-4.4 21.576-17.387 26.681-24.99-30.688-3.947-59.732-11.431-79.2-21.645-29.757-15.609-44.845-37.964-44.845-66.445z" fill="#fff"/></svg>
				</span>
				<span class="q-logo-text">Community</span>
			</a>
			<div class="q-user-menu">
				<div class="q-user-menu__icon hidden">
					<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="19" height="23">
						<g fill="currentColor">
							<g transform="translate(3 -.093)">
								<path d="M6.284.092a5.709 5.709 0 1 1-.002 11.418A5.709 5.709 0 0 1 6.284.092"></path>
							</g>
							<g transform="translate(0 11.907)">
								<path d="M.187 7.575C-.476 9.195.703 11 2.47 11h13.922c1.767 0 2.946-1.804 2.283-3.425C16.945 3.45 13.445.65 9.431.65c-4.015 0-7.55 2.8-9.244 6.925"></path>
							</g>
						</g>
					</svg>
				</div>
			</div>
		</div>
	</header><!-- #masthead -->
</div>

<div class="q-search__container">
	<div class="q-search">

		<div id="searchbox">
			<div class="q-coveo__wrapper">
				<div class="q-coveo-searchbutton">
					<div class="CoveoSearchButton"></div>
				</div>
				<div class="q-coveo-querybox">
					<div class="CoveoOmnibox" data-enable-query-suggest-addon="true"></div>
				</div>
			</div>
		</div>

	</div>
</div>

<div id="page" class="q-main_content">

	
		<div class='q-home-header__sidebar q-blog__home-link'>
		<div class='q-blog__home-link-wrapper'>
			<div class="q-menu__home-container"><ul id="menu-blog-home" class="menu"><a href='/'>
					<img class='link-arrow' src='https://d1uyme8f6ss6qi.cloudfront.net/image/icon/link-arrow-left.svg' width='7' height='10'>
					<span>Blog Home</span>
				</a></li>
</ul></div>		</div>
	</div>

	
	<div class="q-main_content-container">

	<main id="primary" class="site-main q-single__post-content">

		
<article id="post-27395" class="post-27395 post type-post status-publish format-standard has-post-thumbnail hentry category-vulnerabilities-research tag-linux tag-sudo tag-sudoedit tag-unix tag-vulnerability">
	<header class="entry-header">	
		<h1 class="q-blog__post-title">CVE-2021-3156: Heap-Based Buffer Overflow in Sudo (Baron Samedit)</h1>		<div class="q-post__entry-header-outerwrapper">
			<div class="q-post__entry-header-wrapper">
				<div class="q-post__entry-header">
					<div class="q-post__entry-avatar">
						<img src='https://secure.gravatar.com/avatar/6b56a4a104caea7ad8f68d947de5b2f5?s=110&d=mm&r=g' width='54' alt='Animesh Jain' />					</div>
					<div class="entry-meta q-post__entry-meta">
						<div class="q-post__entry-author">
							<span class="byline"> <span class="author vcard"><a class="url fn n" href="https://blog.qualys.com/author/ajain">Animesh Jain</a></span>, Vulnerability Signatures Product Manager, Qualys</span>						</div>
						<div class="q-post__entry-time">
							<span class="posted-on"><a href="https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit" rel="bookmark"><time class="entry-date published" datetime="2021-01-26T10:09:09-08:00">January 26, 2021</time><time class="updated" datetime="2021-02-03T14:29:53-08:00">February 3, 2021</time></a></span> - 12 min read						</div>
					</div>
				</div>
				<div class="q-post__entry-vote">
					<div class='likebutton likebutton_json' data-postid='27395' data-style='style1'></div>				</div>
			</div>
					</div>
	</header>

	<div class="entry-content">
		
<p><strong>Update Feb 3, 2021</strong>: It <a href="https://twitter.com/hackerfantastic/status/1356645638151303169">has been reported</a> that macOS, AIX, and<br>Solaris are also vulnerable to CVE-2021-3156, and that others may also<br>still be vulnerable. Qualys has not independently verified the exploit.</p>



<p><strong>Original Post</strong>: The Qualys Research Team has discovered a heap overflow vulnerability in sudo, a near-ubiquitous utility available on major Unix-like operating systems. Any unprivileged user can gain root privileges on a vulnerable host using a default sudo configuration by exploiting this vulnerability.</p>



<p>Sudo is a powerful utility that‚Äôs included in most if not all Unix- and Linux-based OSes. It allows users to run programs with the security privileges of another user. The vulnerability itself has been hiding in plain sight for nearly 10 years. It was introduced in July 2011 (commit 8255ed69) and affects all legacy versions from 1.8.2 to 1.8.31p2 and all stable versions from 1.9.0 to 1.9.5p1 in their default configuration.</p>



<p>Successful exploitation of this vulnerability allows any unprivileged user to gain root privileges on the vulnerable host. Qualys security researchers have been able to independently verify the vulnerability and develop multiple variants of exploit and obtain full root privileges on Ubuntu 20.04 (Sudo 1.8.31), Debian 10 (Sudo 1.8.27), and Fedora 33 (Sudo 1.9.2). Other operating systems and distributions are also likely to be exploitable.</p>



<p>As soon as the Qualys research team confirmed the vulnerability, Qualys engaged in responsible vulnerability disclosure and coordinated with sudo‚Äôs author and open source distributions to announce the vulnerability.</p>



<h3>Disclosure Timeline</h3>



<ul><li>2021-01-13: Advisory sent to&nbsp;Todd.Miller@sudo</li><li>2021-01-19: Advisory and patches sent to&nbsp;distros@openwall</li><li>2021-01-26: Coordinated Release Date (6:00 PM UTC)</li></ul>



<span id="more-27395"></span>



<h3>Proof of Concept&nbsp;Video&nbsp;</h3>



<figure class="wp-block-embed-vimeo alignwide wp-block-embed is-type-video is-provider-vimeo wp-embed-aspect-4-3 wp-has-aspect-ratio"><div class="wp-block-embed__wrapper">
<div class="embed-vimeo" style="text-align: center;"><iframe src="https://player.vimeo.com/video/504872555" width="640" height="360" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>
</div></figure>



<p></p>



<h3>Technical Details</h3>



<p>If Sudo is executed to run a command in &#8220;shell&#8221; mode (shell -c command):</p>



<ul><li>either through the -s option, which sets Sudo&#8217;s MODE_SHELL flag; OR</li><li>through the -i option, which sets Sudo&#8217;s MODE_SHELL and MODE_LOGIN_SHELL flags; then, at the beginning of Sudo&#8217;s main(), parse_args() rewrites argv (lines 609-617), by concatenating all command-line arguments (lines 587-595) and by escaping all meta-characters with backslashes (lines 590-591):</li></ul>



<pre class="wp-block-code"><code>-------------------------------------------------------------------- 
571     if (ISSET(mode, MODE_RUN) &amp;&amp; ISSET(flags, MODE_SHELL)) { 
572         char **av, *cmnd = NULL; 
573         int ac = 1; 
... 
581             cmnd = dst = reallocarray(NULL, cmnd_size, 2); 
... 
587             for (av = argv; *av != NULL; av++) { 
588                 for (src = *av; *src != '\0'; src++) { 
589                     /* quote potential meta characters */ 
590                     if (!isalnum((unsigned char)*src) &amp;&amp; *src != '_' &amp;&amp; *src != '-' &amp;&amp; *src != '$') 
591                         *dst++ = '\\'; 
592                     *dst++ = *src; 
593                 } 
594                 *dst++ = ' '; 
595             } 
... 
600             ac += 2; /* -c cmnd */ 
... 
603         av = reallocarray(NULL, ac + 1, sizeof(char *)); 
... 
609         av&#91;0] = (char *)user_details.shell; /* plugin may override shell */ 
610         if (cmnd != NULL) { 
611             av&#91;1] = "-c"; 
612             av&#91;2] = cmnd; 
613         } 
614         av&#91;ac] = NULL; 
615  
616         argv = av; 
617         argc = ac; 
618     } 
--------------------------------------------------------------------- </code></pre>



<p>Later, in sudoers_policy_main(), set_cmnd() concatenates the command-line arguments into a heap-based buffer &#8220;user_args&#8221; (lines 864-871) and unescapes the meta-characters (lines 866-867), &#8220;for sudoers matching and logging purposes&#8221;:</p>



<pre class="wp-block-code"><code>--------------------------------------------------------------  
819     if (sudo_mode &amp; (MODE_RUN | MODE_EDIT | MODE_CHECK)) { 
... 
852             for (size = 0, av = NewArgv + 1; *av; av++) 
853                 size += strlen(*av) + 1; 
854             if (size == 0 || (user_args = malloc(size)) == NULL) { 
... 
857             } 
858             if (ISSET(sudo_mode, MODE_SHELL|MODE_LOGIN_SHELL)) { 
... 
864                 for (to = user_args, av = NewArgv + 1; (from = *av); av++) { 
865                     while (*from) { 
866                         if (from&#91;0] == '\\' &amp;&amp; !isspace((unsigned char)from&#91;1])) 
867                             from++; 
868                         *to++ = *from++; 
869                     } 
870                     *to++ = ' '; 
871                 } 
... 
884             } 
... 
886     } 
--------------------------------------------------------------------- </code></pre>



<p>Unfortunately, if a command-line argument ends with a single backslash character, then:</p>



<ul><li>at line 866, &#8220;from[0]&#8221; is the backslash character, and &#8220;from[1]&#8221; is the argument&#8217;s null terminator (i.e., not a space character);</li><li>at line 867, &#8220;from&#8221; is incremented and points to the null terminator;</li><li>at line 868, the null terminator is copied to the &#8220;user_args&#8221; buffer, and &#8220;from&#8221; is incremented again and points to the first character after the null terminator (i.e., out of the argument&#8217;s bounds);</li><li>the &#8220;while&#8221; loop at lines 865-869 reads and copies out-of-bounds characters to the &#8220;user_args&#8221; buffer.</li></ul>



<p>In other words, set_cmnd() is vulnerable to a heap-based buffer overflow, because the out-of-bounds characters that are copied to the &#8220;user_args&#8221; buffer were not included in its size (calculated at lines852-853).</p>



<p>In theory, however, no command-line argument can end with a single backslash character: if MODE_SHELL or MODE_LOGIN_SHELL is set (line 858, a necessary condition for reaching the vulnerable code), then MODE_SHELL is set (line 571) and parse_args() already escaped all meta-characters, including backslashes (i.e., it escaped every single backslash with a second backslash).</p>



<p>In practice, however, the vulnerable code in set_cmnd() and the escape code in parse_args() are surrounded by slightly different conditions:</p>



<pre class="wp-block-code"><code>--------------------------------------------------------------------- 
819     if (sudo_mode &amp; (MODE_RUN | MODE_EDIT | MODE_CHECK)) { 
... 
858             if (ISSET(sudo_mode, MODE_SHELL|MODE_LOGIN_SHELL)) { 
--------------------------------------------------------------------- </code></pre>



<p>versus:</p>



<pre class="wp-block-code"><code>--------------------------------------------------------------------- 
571     if (ISSET(mode, MODE_RUN) &amp;&amp; ISSET(flags, MODE_SHELL)) { 
--------------------------------------------------------------------- </code></pre>



<p>Our question is: can we set MODE_SHELL and either MODE_EDIT or MODE_CHECK (to reach the vulnerable code) but not the default MODE_RUN (to avoid the escape code)?</p>



<p>The answer, it seems, is no: if we set MODE_EDIT (-e option, line 361) or MODE_CHECK (-l option, lines 423 and 519), then parse_args() removes MODE_SHELL from the &#8220;valid_flags&#8221; (lines 363 and 424) and exits with an error if we specify an invalid flag such as MODE_SHELL (lines 532-533):</p>



<pre class="wp-block-code"><code>--------------------------------------------------------------------- 
358                 case 'e': 
... 
361                     mode = MODE_EDIT; 
362                     sudo_settings&#91;ARG_SUDOEDIT].value = "true"; 
363                     valid_flags = MODE_NONINTERACTIVE; 
364                     break; 
... 
416                 case 'l': 
... 
423                     mode = MODE_LIST; 
424                     valid_flags = MODE_NONINTERACTIVE|MODE_LONG_LIST; 
425                     break; 
... 
518     if (argc > 0 &amp;&amp; mode == MODE_LIST) 
519         mode = MODE_CHECK; 
... 
532     if ((flags &amp; valid_flags) != flags) 
533         usage(1); 
--------------------------------------------------------------------- </code></pre>



<p>But we found a loophole: if we execute Sudo as &#8220;sudoedit&#8221; instead of &#8220;sudo&#8221;, then parse_args() automatically sets MODE_EDIT (line 270) but does not reset &#8220;valid_flags&#8221;, and the &#8220;valid_flags&#8221; include MODE_SHELL by default (lines 127 and 249):</p>



<pre class="wp-block-code"><code>--------------------------------------------------------------------- 
127 #define DEFAULT_VALID_FLAGS     (MODE_BACKGROUND|MODE_PRESERVE_ENV|MODE_RESET_HOME|MODE_LOGIN_SHELL|MODE_NONINTERACTIVE|MODE_SHELL) 
... 
249     int valid_flags = DEFAULT_VALID_FLAGS; 
... 
267     proglen = strlen(progname); 
268     if (proglen > 4 &amp;&amp; strcmp(progname + proglen - 4, "edit") == 0) { 
269         progname = "sudoedit"; 
270         mode = MODE_EDIT; 
271         sudo_settings&#91;ARG_SUDOEDIT].value = "true"; 
272     } 
------------------------------------------------------------------------ </code></pre>



<p>Consequently, if we execute &#8220;sudoedit -s&#8221;, then we set both MODE_EDIT and MODE_SHELL (but not MODE_RUN), we avoid the escape code, reach the vulnerable code, and overflow the heap-based buffer &#8220;user_args&#8221; through a command-line argument that ends with a single backslash character:</p>



<pre class="wp-block-code"><code>--------------------------------------------------------------------- 
sudoedit -s '\' `perl -e 'print "A" x 65536'` 
malloc(): corrupted top size 
Aborted (core dumped) 
---------------------------------------------------------------------</code></pre>



<p>From an attacker&#8217;s point of view, this buffer overflow is ideal due to following reasons:</p>



<p>1) The attacker controls the size of the &#8220;user_args&#8221; buffer that can be overflowed (the size of our concatenated command-line arguments, at lines 852-854);</p>



<p>2) The attacker independently controls the size and contents of the overflow itself (our last command-line argument is conveniently followed by our first environment variables, which are not included in the size calculation at lines 852-853);</p>



<p>3) The attacker can even write null bytes to the buffer that was overflowed (every command-line argument or environment variable that ends with a single backslash writes a null byte to &#8220;user_args&#8221;, at lines 866-868).</p>



<p>For example, on an amd64 Linux, the following command allocates a 24-byte &#8220;user_args&#8221; buffer (a 32-byte heap chunk) and overwrites the next chunk&#8217;s size field with &#8220;A=a\0B=b\0&#8221; (0x00623d4200613d41), its fd field with &#8220;C=c\0D=d\0&#8221; (0x00643d4400633d43), and its bk field with &#8220;E=e\0F=f\0&#8221; (0x00663d4600653d45):</p>



<pre class="wp-block-code"><code>--------------------------------------------------------------------- 
env -i 'AA=a\' 'B=b\' 'C=c\' 'D=d\' 'E=e\' 'F=f' sudoedit -s '1234567890123456789012\' 
--------------------------------------------------------------------- 

--|--------+--------+--------+--------|--------+--------+--------+--------+-- 
  |        |        |12345678|90123456|789012.A|A=a.B=b.|C=c.D=d.|E=e.F=f.| 
--|--------+--------+--------+--------|--------+--------+--------+--------+-- 

              size  &lt;---- user_args buffer ---->  size      fd       bk </code></pre>



<h3>Solution</h3>



<p>Given the breadth of the attack surface for this vulnerability, Qualys recommends users apply patches for this vulnerability immediately. </p>



<p>Qualys customers can search the vulnerability knowledgebase for CVE-2021-3156 to identify all the QIDs and assets vulnerable for this vulnerability.</p>



<p>If you are not a customer, start your free&nbsp;<a rel="noreferrer noopener" href="https://www.qualys.com/subscriptions/vmdr/" target="_blank">Qualys VMDR trial</a>&nbsp;to get full access to the QIDs (detections) for CVE-2021-3156, so you can identify your vulnerable assets.</p>



<h3>Qualys Coverage</h3>



<p>Qualys is releasing the QIDs in the table below as they become available starting with vulnsigs version VULNSIGS-2.5.90-4 and in Linux Cloud Agent manifest version lx_manifest-2.5.90.4-3.</p>



<figure class="wp-block-table alignwide is-style-stripes">
  <table>
    <tbody>
      <tr>
        <td><strong>QID</strong></td>
        <td><strong>Title</strong></td>
        <td><strong>O/S</strong></td>
        <td><strong><span style="white-space:nowrap;">Advisory</span></strong></td>
        <td><strong><span style="white-space:nowrap;">Version*</span></strong></td>
      </tr>
      <tr>
        <td><span style="white-space:nowrap;">352207&nbsp;</span></td>
        <td>Amazon Linux Security Advisory for sudo: ALAS2-2021-1590 (Baron Samedit))</td>
        <td><span style="white-space:nowrap;">Amazon Linux&nbsp;</span></td>
        <td><a href="https://alas.aws.amazon.com/AL2/ALAS-2021-1590.html">ALAS2-2021-1590 </a></td>
        <td>VULNSIGS-2.5.94-2 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>352208</td>
        <td>Amazon Linux Security Advisory for sudo: ALAS-2021-1478 (Baron Samedit)</td>
        <td><span style="white-space:nowrap;">Amazon Linux&nbsp;</span></td>
        <td><a href="https://alas.aws.amazon.com/ALAS-2021-1478.html">ALAS-2021-1478</a></td>
        <td>VULNSIGS-2.5.94-2 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>174570</td>
        <td>SUSE Enterprise Linux Security Update for sudo (SUSE-SU-2021:0226-1) (Baron Samedit)</td>
        <td>SUSE Enterprise Linux</td>
        <td><a href="https://lists.suse.com/pipermail/sle-security-updates/2021-January/008249.html">SUSE-SU-2021:0226-1</a></td>
        <td>VULNSIGS-2.5.94-2 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>174571</td>
        <td>SUSE Enterprise Linux Security Update for sudo (SUSE-SU-2021:0227-1) (Baron Samedit)</td>
        <td>SUSE Enterprise Linux</td>
        <td><a href="https://lists.suse.com/pipermail/sle-security-updates/2021-January/008250.html">SUSE-SU-2021:0227-1</a></td>
        <td>VULNSIGS-2.5.94-2 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>174572</td>
        <td>SUSE Enterprise Linux Security Update for sudo (SUSE-SU-2021:0225-1) (Baron Samedit)</td>
        <td>SUSE Enterprise Linux</td>
        <td><a href="https://lists.suse.com/pipermail/sle-security-updates/2021-January/008251.html">SUSE-SU-2021:0225-1</a></td>
        <td>VULNSIGS-2.5.94-2 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>178379</td>
        <td>Debian Security Update for sudo (DSA 4839-1) (Baron Samedit)</td>
        <td>Debian</td>
        <td><a href="https://lists.debian.org/debian-security-announce/2021/msg00020.html">DSA 4839-1</a></td>
        <td>VULNSIGS-2.5.94-2 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>198231</td>
        <td>Ubuntu Security Notification for Sudo Vulnerabilities : USN-4705-1(Baron Samedit)</td>
        <td>Ubuntu</td>
        <td><a href="https://usn.ubuntu.com/4705-1/">USN-4705-1</a></td>
        <td>VULNSIGS-2.5.94-2 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>374915</td>
        <td>Gentoo Linux Sudo Multiple Vulnerabilities (GLSA 202101-33) (Baron Samedit)</td>
        <td>Gentoo</td>
        <td><a href="https://security.gentoo.org/glsa/202101-33">GLSA 202101-33</a></td>
        <td>VULNSIGS-2.5.94-2 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>158992</td>
        <td>Oracle Enterprise Linux Security Update for sudo (ELSA-2021-0221)(Baron Samedit)</td>
        <td>Oracle Enterprise Linux</td>
        <td><a href="https://linux.oracle.com/errata/ELSA-2021-0221.html">ELSA-2021-0221</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>158993</td>
        <td>Oracle Enterprise Linux Security Update for sudo (ELSA-2021-0218)(Baron Samedit)</td>
        <td>Oracle Enterprise Linux</td>
        <td><a href="https://linux.oracle.com/errata/ELSA-2021-0218.html">ELSA-2021-0218</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>158994</td>
        <td>Oracle Enterprise Linux Security Update for sudo (ELSA-2021-9019)(Baron Samedit)</td>
        <td>Oracle Enterprise Linux</td>
        <td><a href="https://linux.oracle.com/errata/ELSA-2021-9019.html">ELSA-2021-9019</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>178383</td>
        <td>Debian Security Update for sudo (DLA 2534-1) (Baron Samedit)</td>
        <td>Debian</td>
        <td><a href="https://lists.debian.org/debian-lts-announce/2021/01/msg00022.html">DLA 2534-1</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>239026</td>
        <td>Red Hat Update for sudo (RHSA-2021:0218) (Baron Samedit)</td>
        <td>Red Hat</td>
        <td><a href="https://access.redhat.com/errata/RHSA-2021:0218?language=en">RHSA-2021:0218</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>239027</td>
        <td>Red Hat Update for sudo (RHSA-2021:0219) (Baron Samedit)</td>
        <td>Red Hat</td>
        <td><a href="https://access.redhat.com/errata/RHSA-2021:0219?language=en">RHSA-2021:0219</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>239028</td>
        <td>Red Hat Update for sudo (RHSA-2021:0220) (Baron Samedit)</td>
        <td>Red Hat</td>
        <td><a href="https://access.redhat.com/errata/RHSA-2021:0220?language=en">RHSA-2021:0220</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>239029</td>
        <td>Red Hat Update for sudo (RHSA-2021:0221) (Baron Samedit)</td>
        <td>Red Hat</td>
        <td><a href="https://access.redhat.com/errata/RHSA-2021:0221?language=en">RHSA-2021:0221</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>239030</td>
        <td>Red Hat Update for sudo (RHSA-2021:0222) (Baron Samedit)</td>
        <td>Red Hat</td>
        <td><a href="https://access.redhat.com/errata/RHSA-2021:0222?language=en">RHSA-2021:0222</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>239031</td>
        <td>Red Hat Update for sudo (RHSA-2021:0223) (Baron Samedit)</td>
        <td>Red Hat</td>
        <td><a href="https://access.redhat.com/errata/RHSA-2021:0223?language=en">RHSA-2021:0223</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>239032</td>
        <td>Red Hat Update for sudo (RHSA-2021:0227) (Baron Samedit)</td>
        <td>Red Hat</td>
        <td><a href="https://access.redhat.com/errata/RHSA-2021:0227?language=en">RHSA-2021:0227</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>257056</td>
        <td>CentOS Security Update for sudo Security Update (CESA-2021:0221) (Baron Samedit)</td>
        <td>CentOS</td>
        <td><a href="https://lists.centos.org/pipermail/centos-announce/2021-January/048252.html">CESA-2021:0221</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>280866</td>
        <td>Fedora Security Update for sudo (FEDORA-2021-8840cbdccd) (Baron Samedit) </td>
        <td>Fedora</td>
        <td><a href="https://bodhi.fedoraproject.org/updates/FEDORA-2021-8840cbdccd">FEDORA-2021-8840cbdccd</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>280868</td>
        <td>Fedora Security Update for sudo (FEDORA-2021-2cb63d912a) (Baron Samedit)</td>
        <td>Fedora</td>
        <td><a href="https://bodhi.fedoraproject.org/updates/FEDORA-2021-2cb63d912a">FEDORA-2021-2cb63d912a</a></td>
        <td>VULNSIGS-2.5.94-4 / 2.5.94.4-3</td>
      </tr>
      <tr>
        <td>352217</td>
        <td>Amazon Linux Security Advisory for sudo: AL2012-2021-335 (Baron Samedit) </td>
        <td>Amazon Linux</td>
        <td>AL2012-2021-335</td>
        <td>VULNSIGS-2.5.95-2 / 2.5.95.2-1</td>
      </tr>
      <tr>
        <td>374891</td>
        <td>Sudo Heap-based Buffer Overflow Vulnerability (Baron Samedit)</td>
        <td>Local</td>
        <td><a href="https://www.sudo.ws/alerts/unescape_overflow.html">Sudo Security Alerts</a></td>
        <td>VULNSIGS-2.5.90-4 / 2.5.90.4-3</td>
      </tr>
    </tbody>
  </table>
</figure>



<p>* Version is the signature version followed by the Linux manifest version.</p>



<h3>Dashboard</h3>



<p>With VMDR Dashboard, you can track this vulnerability, their impacted hosts, their status and overall management in real time. With trending enabled for dashboard widgets, you can keep track of these vulnerabilities trends in your environment using the ‚ÄúBaron Samedit | Heap-based buffer overflow Sudo‚Äù Dashboard.</p>



<p>View and download <a href="https://qualys-secure.force.com/customer/s/article/000006518">the Baron Samedit dashboard</a>.</p>



<figure class="wp-block-image alignwide size-large"><img data-attachment-id="27401" data-permalink="https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit/attachment/baron-samedit-dashboard" data-orig-file="https://blog.qualys.com/wp-content/uploads/2021/01/baron-samedit-dashboard.png" data-orig-size="1485,825" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="baron-samedit-dashboard" data-image-description data-medium-file="https://blog.qualys.com/wp-content/uploads/2021/01/baron-samedit-dashboard-300x167.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2021/01/baron-samedit-dashboard-1070x594.png" loading="lazy" width="1070" height="594" src="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2021/01/baron-samedit-dashboard-1070x594.png" alt class="wp-image-27401 jetpack-lazy-image" data-lazy-srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2021/01/baron-samedit-dashboard-1070x594.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2021/01/baron-samedit-dashboard-300x167.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2021/01/baron-samedit-dashboard-768x427.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2021/01/baron-samedit-dashboard.png 1485w" data-lazy-sizes="(max-width: 1070px) 100vw, 1070px" data-lazy-src="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2021/01/baron-samedit-dashboard-1070x594.png?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><noscript><img data-attachment-id="27401" data-permalink="https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit/attachment/baron-samedit-dashboard" data-orig-file="https://blog.qualys.com/wp-content/uploads/2021/01/baron-samedit-dashboard.png" data-orig-size="1485,825" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="baron-samedit-dashboard" data-image-description="" data-medium-file="https://blog.qualys.com/wp-content/uploads/2021/01/baron-samedit-dashboard-300x167.png" data-large-file="https://blog.qualys.com/wp-content/uploads/2021/01/baron-samedit-dashboard-1070x594.png" loading="lazy" width="1070" height="594" src="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2021/01/baron-samedit-dashboard-1070x594.png" alt="" class="wp-image-27401" srcset="https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2021/01/baron-samedit-dashboard-1070x594.png 1070w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2021/01/baron-samedit-dashboard-300x167.png 300w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2021/01/baron-samedit-dashboard-768x427.png 768w, https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/uploads/2021/01/baron-samedit-dashboard.png 1485w" sizes="(max-width: 1070px) 100vw, 1070px" /></noscript><figcaption>Baron Samedit dashboard</figcaption></figure>



<h3>Vendor References</h3>



<ul><li><a href="https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt">Baron Samedit Security Advisory</a> (<a href="https://www.qualys.com/research/security-advisories/">All Qualys Security Advisories</a>)</li><li><a href="https://www.sudo.ws/alerts/unescape_overflow.html">Sudo Alert for Baron Samedit</a> (<a href="https://www.sudo.ws/security.html">All Sudo Security Alerts</a>)</li></ul>



<h3>Frequently Asked Questions (FAQs)</h3>



<h6>What versions are vulnerable?</h6>



<p>The following versions of sudo are vulnerable:</p>



<ul><li>All legacy versions from 1.8.2 to 1.8.31p2</li><li>All stable versions from 1.9.0 to 1.9.5p1</li></ul>



<h6>How can I test if I have vulnerable version?</h6>



<p>To test if a system is vulnerable or not, login to the system as a non-root user.</p>



<p>Run command &#8220;sudoedit -s /&#8221;</p>



<p>If the system is vulnerable, it will respond with an error that starts with &#8220;sudoedit:&#8221;</p>



<p>If the system is patched, it will respond with an error that starts with &#8220;usage:&#8221;</p>



<h6>Are versions before 1.8.2 vulnerable?</h6>



<p>No. See explanation above.</p>



<h6>I&#8217;m running a vulnerable version of sudo from the list mentioned above. Why does the test show my host is not vulnerable?</h6>



<p>Operating system vendors don&#8217;t always update the software&#8217;s version number after introducing a patch to the software, particularly when they backport the patch. For example, Ubuntu released a patch (USN-4705-1) for Ubuntu 20.04, but the patched version is still 1.8.31 after the patch is installed.</p>



<h6>Why am I seeing multiple QIDs for the same CVE-2021-3156 on the same host?</h6>



<p>Qualys released a generic QID at the time of release which detected the vulnerability based on the output of the command <code>sudoedit</code>. Later on, as OS vendors released patches, we released QIDs based on package versions as well. So, it is possible for a vulnerable asset to have the vulnerability reported for QID 374891, and OS specific checks that were released later on.</p>



<h6>What are the possible reasons for QID 374891 not triggering against vulnerable systems?</h6>



<p>QID 374891 was released with vulnsigs version VULNSIGS-2.5.90-4 and in Linux Cloud Agent manifest version lx_manifest-2.5.90.4-3. For the vulnerabilities to be reported these signature and manifest versions need to be available on the platform (the deployment schedule varies), and agents have completed a scan with the latest versions of the signatures.</p>



<p>Also, Qualys released more QIDs based on the security advisories and patches released by various Linux distributions. So certain Linux distributions had coverage before the rest. For e.g., Amazon Linux security advisory was released first, and CentOS advisories, and patches were released couple of days later. Support for CentOS linux was added to later versions vulnsigs and manifests. See table above for details.</p>



<h6>For CVE-2021-3156, what is the difference in the detection logic between QID 374891 and the rest of the QIDs?</h6>



<p>QID 374891 attempts to confirm the vulnerability based on output of command <code>sudoedit</code>. The rest of the QIDs confirm the vulnerability based on version comparison based on the versions disclosed by the OS vendor in their respective security advisories.</p>



<h6>Is a local user required to exploit the vulnerability?</h6>



<p>Yes. However, this user does not need to be a privileged user or be a part of sudoers list. For example, even account ‚Äònobody‚Äô can exploit the issue.</p>



<h6>Why name the vulnerability ‚ÄúBaron Samedit‚Äù?</h6>



<p>It‚Äôs a play on Baron Samedi and sudoedit.</p>



<h6>Will Qualys Research Team publish exploit code for this vulnerability?&nbsp;</h6>



<p>No<strong>.</strong>&nbsp;</p>

<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>	</div>

	<footer class="entry-footer">
		<div class='q-single-post__footer-content'>
						<div class='q-single-post__footer-author'>
							<div class='q-post__entry-avatar'>
								<img src='https://secure.gravatar.com/avatar/6b56a4a104caea7ad8f68d947de5b2f5?s=180&d=mm&r=g' width='90' alt='Animesh Jain' />
							</div>
							<div class='q-post__entry-author'>
								<div class='q-post__entry-writtenby'>Written by</div>
								<span class="byline"> <span class="author vcard"><a class="url fn n" href="https://blog.qualys.com/author/ajain">Animesh Jain</a></span>, Vulnerability Signatures Product Manager, Qualys</span>
								<div class='q-post__entry-author-email'>Write to Animesh at <a href='mailto:ajain@qualys.com'>ajain@qualys.com</a></div>
							</div>
						</div>
						<div class='q-single-post__footer-actions'>
							<div class='q-single-post__action'><label>Like</label><div class='likebutton likebutton_json' data-postid='27395' data-style='style2'></div></div>
							<div class="q-single-post__action"><label>Share</label><div class="ShariffSC" style="border-top: 1px solid #ddd; border-top: 1px solid rgba(0,0,0,.2); padding-top: 2em;"><div class="shariff shariff-align-flex-start shariff-widget-align-flex-start" style="display:none"><ul class="shariff-buttons theme-round orientation-horizontal buttonsize-medium"><li class="shariff-button facebook" style="background-color:#97A0AF"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.qualys.com%2Fvulnerabilities-research%2F2021%2F01%2F26%2Fcve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit" title="Share on Facebook" aria-label="Share on Facebook" role="button" rel="nofollow" class="shariff-link" style="; background-color:#6A778B; color:#fff" target="_blank"><span class="shariff-icon" style=""><svg width="32px" height="20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 32"><path fill="#3b5998" d="M17.1 0.2v4.7h-2.8q-1.5 0-2.1 0.6t-0.5 1.9v3.4h5.2l-0.7 5.3h-4.5v13.6h-5.5v-13.6h-4.5v-5.3h4.5v-3.9q0-3.3 1.9-5.2t5-1.8q2.6 0 4.1 0.2z"/></svg></span></a></li><li class="shariff-button twitter" style="background-color:#97A0AF"><a href="https://twitter.com/share?url=https%3A%2F%2Fblog.qualys.com%2Fvulnerabilities-research%2F2021%2F01%2F26%2Fcve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit&text=CVE-2021-3156%3A%20Heap-Based%20Buffer%20Overflow%20in%20Sudo%20%28Baron%20Samedit%29&via=qualys" title="Share on Twitter" aria-label="Share on Twitter" role="button" rel="noopener nofollow" class="shariff-link" style="; background-color:#6A778B; color:#fff" target="_blank"><span class="shariff-icon" style=""><svg width="32px" height="20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 32"><path fill="#55acee" d="M29.7 6.8q-1.2 1.8-3 3.1 0 0.3 0 0.8 0 2.5-0.7 4.9t-2.2 4.7-3.5 4-4.9 2.8-6.1 1q-5.1 0-9.3-2.7 0.6 0.1 1.5 0.1 4.3 0 7.6-2.6-2-0.1-3.5-1.2t-2.2-3q0.6 0.1 1.1 0.1 0.8 0 1.6-0.2-2.1-0.4-3.5-2.1t-1.4-3.9v-0.1q1.3 0.7 2.8 0.8-1.2-0.8-2-2.2t-0.7-2.9q0-1.7 0.8-3.1 2.3 2.8 5.5 4.5t7 1.9q-0.2-0.7-0.2-1.4 0-2.5 1.8-4.3t4.3-1.8q2.7 0 4.5 1.9 2.1-0.4 3.9-1.5-0.7 2.2-2.7 3.4 1.8-0.2 3.5-0.9z"/></svg></span></a></li><li class="shariff-button mailto" style="background-color:#97A0AF"><a href="mailto:?body=https%3A%2F%2Fblog.qualys.com%2Fvulnerabilities-research%2F2021%2F01%2F26%2Fcve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit&subject=CVE-2021-3156%3A%20Heap-Based%20Buffer%20Overflow%20in%20Sudo%20%28Baron%20Samedit%29" title="Send by email" aria-label="Send by email" role="button" rel="noopener nofollow" class="shariff-link" style="; background-color:#6A778B; color:#fff"><span class="shariff-icon" style=""><svg width="32px" height="20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="#999" d="M32 12.7v14.2q0 1.2-0.8 2t-2 0.9h-26.3q-1.2 0-2-0.9t-0.8-2v-14.2q0.8 0.9 1.8 1.6 6.5 4.4 8.9 6.1 1 0.8 1.6 1.2t1.7 0.9 2 0.4h0.1q0.9 0 2-0.4t1.7-0.9 1.6-1.2q3-2.2 8.9-6.1 1-0.7 1.8-1.6zM32 7.4q0 1.4-0.9 2.7t-2.2 2.2q-6.7 4.7-8.4 5.8-0.2 0.1-0.7 0.5t-1 0.7-0.9 0.6-1.1 0.5-0.9 0.2h-0.1q-0.4 0-0.9-0.2t-1.1-0.5-0.9-0.6-1-0.7-0.7-0.5q-1.6-1.1-4.7-3.2t-3.6-2.6q-1.1-0.7-2.1-2t-1-2.5q0-1.4 0.7-2.3t2.1-0.9h26.3q1.2 0 2 0.8t0.9 2z"/></svg></span></a></li></ul></div></div></div>
						</div>
					</div>
					<div class='q-post__tags-wrapper'>
						<div class='q-post__tags-container'>
							<h5>Related content</h5>
							<div class='q-post__tags-list'>
							<a href="https://blog.qualys.com/tag/linux" rel="tag">linux</a>, <a href="https://blog.qualys.com/tag/sudo" rel="tag">sudo</a>, <a href="https://blog.qualys.com/tag/sudoedit" rel="tag">sudoedit</a>, <a href="https://blog.qualys.com/tag/unix" rel="tag">unix</a>, <a href="https://blog.qualys.com/tag/vulnerability" rel="tag">vulnerability</a>
							</div>
						</div>
					</div>	</footer>
</article>

<div class="q-comments__show-button js-q-comments-button">
	<span class='text'>Share your Comments</span> <span class='arrow-icon'><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 23 14"><path fill="#FFF" d="M20.469.409l2.122 2.122-11.061 11.06L.469 2.531 2.591.409l8.939 8.94z"/></svg></span></div>
<div id="comments" class="comments-area">

		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Comments <small><a rel="nofollow" id="cancel-comment-reply-link" href="/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://blog.qualys.com/wp-comments-post.php?wpe-comment-post=qualysblog" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label><textarea id="comment" name="comment" cols="45" rows="6" placeholder="Share your thoughts" aria-required="true"></textarea></p><div class="field-wrapper"><p class="comment-form-author"><label for="author">Name</label> <input id="author" name="author" type="text" placeholder="Name" value="" size="20" /></p>
<p class="comment-form-email"><label for="email">Email</label> <input id="email" name="email" type="text" placeholder="Email" value="" size="30" /></p></div>

<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes" /> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="POST" /> <input type='hidden' name='comment_post_ID' value='27395' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="c12a90d4c7" /></p><input type="hidden" id="ak_js" name="ak_js" value="171"/><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

	</main><!-- #main -->


</div><!-- .q-main_content-container -->
</div><!-- #page -->

<footer id="colophon" class="site-footer q-footer">
	<div class="q-footer__container">
		<div class="q-footer__row">

			<div class="q-footer__column--wide q-footer__column--desktop">
				<h2 class="q-footer__heading">
					Join the <span class="nowrap">discussion today!</span>
				</h2>
				<p class="q-footer__copy">
					<strong>Learn</strong> more about Qualys and industry best practices.
				</p>
				<p class="q-footer__copy">
					<strong>Share</strong> what you know and build a reputation.
				</p>
				<p class="q-footer__copy">
					<strong>Secure</strong> your systems and improve security for everyone.
				</p>
				<div class="q-footer__search">
					<span class="q-button__start-a-discussion q-button__light-blue q-button-with-arrow">
						<a href="https://discussions.qualys.com/discussion/create!input.jspa">
							<span>Start a discussion</span>
						</a>
					</span>
				</div>

				<div class="q-footer__social">
					<ul id="social-menu" class="q-social-list"><li id="menu-item-26477" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26477"><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/qualys"><svg class="q-social-list__icon" role="img" aria-label="Qualys on Twitter" width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 148.7 610.7 496.3" enable-background="new 0 148.7 610.7 496.3"><title>Twitter</title><path fill="#FFF" d="M192.1 645c-70.8 0-136.7-20.7-192.1-56.2 9.8 1.1 19.9 1.8 29.9 1.8 58.7 0 112.8-20.1 155.7-53.6-54.7-1.1-101.2-37.3-117-87.1 7.6 1.6 15.4 2.2 23.7 2.2 11.4 0 22.6-1.6 33.1-4.5-57.5-11.6-100.6-62.1-100.6-122.9v-1.6c17 9.4 36.2 15 56.7 15.6-33.5-22.4-55.8-60.6-55.8-104.2 0-23 6.3-44.4 17-63 61.6 75.9 153.9 126 258 131.1-2.2-9.2-3.4-18.8-3.4-28.6 0-69.2 56.1-125.3 125.3-125.3 36 0 68.6 15.2 91.4 39.5 28.8-5.6 55.6-15.9 79.7-30.4-9.4 29.3-29 53.8-54.9 69.5 25.2-3.1 49.6-9.8 71.9-19.7-16.8 25-38 47.1-62.5 64.8.2 5.4.4 10.7.4 16.3 0 165.4-126.2 356.3-356.5 356.3"></path></svg></a></li>
<li id="menu-item-26478" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26478"><a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/qualys"><svg class="q-social-list__icon" role="img" aria-label="Qualys on LinkedIn" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" enable-background="new 0 0 36 36"><title>LinkedIn</title><path fill="#FFF" d="M33.3 0h-30.6c-1.5 0-2.7 1.2-2.7 2.6v30.8c0 1.4 1.2 2.6 2.7 2.6h30.7c1.5 0 2.7-1.2 2.7-2.6v-30.8c-.1-1.4-1.3-2.6-2.8-2.6zm-22.6 30.7h-5.4v-17.2h5.3v17.2zm-2.7-19.6c-1.7 0-3.1-1.4-3.1-3.1 0-1.7 1.4-3 3.1-3 1.7 0 3.1 1.4 3.1 3.1 0 1.7-1.4 3-3.1 3zm22.7 19.6h-5.3v-8.4c0-2 0-4.6-2.8-4.6s-3.2 2.2-3.2 4.4v8.5h-5.4v-17.1h5.1v2.3h.1c.7-1.4 2.5-2.8 5.1-2.8 5.4 0 6.4 3.6 6.4 8.2v9.5z"></path></svg></a></li>
<li id="menu-item-26479" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26479"><a target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/qualys"><svg class="q-social-list__icon" role="img" aria-label="Qualys on Facebook" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 90 611.8 612.2" enable-background="new 0 90 611.8 612.2"><title>Facebook</title><path fill="#FFF" d="M578.3 90h-544.6c-18.6 0-33.7 15.1-33.7 33.7v544.4c0 18.6 15.1 33.7 33.7 33.7h293v-236.9h-79.7v-92.4h79.8v-67.9c0-79.1 48.4-122 118.8-122 33.7 0 62.8 2.5 71.3 3.7v82.5h-48.9c-38.3 0-45.9 18.1-45.9 44.9v58.9h91.5l-11.9 92.4h-79.6v237.1h155.9c18.6 0 33.7-15.1 33.7-33.7v-544.7c.3-18.6-14.8-33.7-33.4-33.7z"></path></svg></a></li>
<li id="menu-item-26480" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26480"><a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/user/QualysGuard"><svg class="q-social-list__icon" role="img" aria-label="Qualys on YouTube" width="22" height="22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1021.5 718.4" enable-background="new 0 0 1021.5 718.4"><title>YouTube</title><path fill="#E0E0E0" d="M647.3 366.3l-242.1-161.6 276 144-33.9 17.6"></path><path fill="#FFF" d="M1011.2 155s-10-70.4-40.6-101.4c-38.8-40.7-82.4-40.9-102.3-43.3-142.9-10.3-357.4-10.3-357.4-10.3h-.4s-214.4 0-357.4 10.3c-20 2.4-63.5 2.6-102.3 43.3-30.6 31-40.6 101.4-40.6 101.4s-10.2 82.6-10.2 165.3v77.5c0 82.7 10.2 165.3 10.2 165.3s10 70.4 40.6 101.4c38.9 40.7 89.9 39.4 112.6 43.7 81.7 7.8 347.3 10.3 347.3 10.3s214.6-.3 357.6-10.7c20-2.4 63.5-2.6 102.3-43.3 30.6-31 40.6-101.4 40.6-101.4s10.2-82.7 10.2-165.3v-77.5c.1-82.7-10.2-165.3-10.2-165.3m-605.9 336.7v-287l276 144-276 143z"></path></svg></a></li>
<li id="menu-item-26481" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26481"><a target="_blank" rel="noopener noreferrer" href="https://vimeo.com/qualys"><svg class="q-social-list__icon" role="img" aria-label="Qualys on Vimeo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 86.67"><title>Vimeo</title><path fill="#FFF" d="M100 20.05q-.72 14.63-20.44 40.06Q59.16 86.67 45 86.67q-8.74 0-14.79-16.17l-8.02-29.66q-4.49-16.17-9.64-16.18-1.12 0-7.85 4.72L0 23.31q7.4-6.52 14.59-13 9.87-8.55 14.82-9 11.67-1.12 14.37 16 2.91 18.47 4 23 3.36 15.32 7.41 15.31 3.14 0 9.43-9.94t6.73-15.13q.9-8.58-6.73-8.58a18.7 18.7 0 0 0-7.4 1.64Q64.63-.66 85.42 0 100.84.47 100 20.05z"></path></svg></a></li>
</ul>				</div>

			</div>
			<div class="q-footer__column q-footer__column--nav">

				<section id="nav_menu-2" class="widget widget_nav_menu q-footer__group"><h3 class="widget-title q-footer__subheading">Qualys</h3><div class="menu-footer-qualys-container"><ul id="menu-footer-qualys" class="menu"><li id="menu-item-26499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26499"><a title="Information Security and Compliance | Qualys, Inc." href="https://www.qualys.com/">Qualys.com</a></li>
<li id="menu-item-26500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26500"><a title="Free Trial | Qualys, Inc." href="https://www.qualys.com/community-edition/">Qualys Community Edition</a></li>
<li id="menu-item-26565" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26565"><a href="https://store.qualys.com/">Qualys Merchandise Store</a></li>
</ul></div></section><section id="nav_menu-3" class="widget widget_nav_menu q-footer__group"><h3 class="widget-title q-footer__subheading">Qualys Communities</h3><div class="menu-footer-qualys-communities-container"><ul id="menu-footer-qualys-communities" class="menu"><li id="menu-item-26501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26501"><a href="https://community.qualys.com/vulnerability-management/">Vulnerability Management</a></li>
<li id="menu-item-26502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26502"><a href="https://community.qualys.com/policy-compliance/">Policy Compliance</a></li>
<li id="menu-item-26503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26503"><a href="https://community.qualys.com/pci-compliance/">PCI Compliance</a></li>
<li id="menu-item-26504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26504"><a href="https://community.qualys.com/web-app-scanning/">Web App Scanning</a></li>
<li id="menu-item-26505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26505"><a href="https://community.qualys.com/web-app-firewall/">Web App Firewall</a></li>
<li id="menu-item-26506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26506"><a href="https://community.qualys.com/continuous-monitoring/">Continuous Monitoring</a></li>
<li id="menu-item-26507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26507"><a href="https://community.qualys.com/security-assessment-questionnaire/">Security Assessment Questionnaire</a></li>
<li id="menu-item-26508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26508"><a href="https://community.qualys.com/threat-protection/">Threat Protection</a></li>
<li id="menu-item-26509" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26509"><a href="https://community.qualys.com/asset-inventory/">Asset Inventory</a></li>
<li id="menu-item-26510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26510"><a href="https://community.qualys.com/asset-view/">AssetView</a></li>
<li id="menu-item-26511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26511"><a href="https://community.qualys.com/cmdb-sync/">CMDB Sync</a></li>
<li id="menu-item-26512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26512"><a href="https://community.qualys.com/indication-of-compromise/">Indication of Compromise</a></li>
<li id="menu-item-26513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26513"><a href="https://community.qualys.com/security-configuration-assessment/">Security Configuration Assessment</a></li>
<li id="menu-item-26514" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26514"><a href="https://community.qualys.com/file-integrity-monitoring/">File Integrity Monitoring</a></li>
<li id="menu-item-26515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26515"><a href="https://community.qualys.com/cloud-inventory/">Cloud Inventory</a></li>
<li id="menu-item-26516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26516"><a href="https://community.qualys.com/certificate-inventory/">Certificate Inventory</a></li>
<li id="menu-item-26517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26517"><a href="https://community.qualys.com/container-security/">Container Security</a></li>
<li id="menu-item-26518" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26518"><a href="https://community.qualys.com/cloud-security-assessment/">Cloud Security Assessment</a></li>
<li id="menu-item-26519" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26519"><a href="https://community.qualys.com/certificate-assessment/">Certificate Assessment</a></li>
<li id="menu-item-26520" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26520"><a href="https://community.qualys.com/out-of-band-configuration-assessment/">Out-of-band Configuration Assessment</a></li>
<li id="menu-item-26521" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26521"><a href="https://community.qualys.com/patch-management/">Patch Management</a></li>
<li id="menu-item-26522" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26522"><a href="https://community.qualys.com/api/">Developer API</a></li>
<li id="menu-item-26523" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26523"><a href="https://community.qualys.com/cloud-agent/">Cloud Agent</a></li>
<li id="menu-item-26524" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26524"><a href="https://community.qualys.com/reporting/">Dashboards &#038; Reporting</a></li>
</ul></div></section><section id="nav_menu-4" class="widget widget_nav_menu q-footer__group"><h3 class="widget-title q-footer__subheading">Discussions</h3><div class="menu-footer-discussions-container"><ul id="menu-footer-discussions" class="menu"><li id="menu-item-26489" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26489"><a href="https://discussions.qualys.com/">All discussions</a></li>
<li id="menu-item-26490" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26490"><a href="https://discussions.qualys.com/community/asset-inventory">Global IT Asset Management</a></li>
<li id="menu-item-26491" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26491"><a href="https://discussions.qualys.com/community/vulnerability-management">IT Security</a></li>
<li id="menu-item-26492" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26492"><a href="https://discussions.qualys.com/community/policy-compliance">Compliance</a></li>
<li id="menu-item-26493" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26493"><a href="https://discussions.qualys.com/community/cloud-security">Cloud &#038; Container Security</a></li>
<li id="menu-item-26494" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26494"><a href="https://discussions.qualys.com/community/web-application-scanning">Web App Security</a></li>
<li id="menu-item-26495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26495"><a href="https://discussions.qualys.com/community/ssllabs">Certificate Security &#038; SSL Labs</a></li>
<li id="menu-item-26496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26496"><a href="https://discussions.qualys.com/community/developer">Developer API</a></li>
</ul></div></section><section id="nav_menu-5" class="widget widget_nav_menu q-footer__group"><h3 class="widget-title q-footer__subheading">Blog</h3><div class="menu-footer-blog-container"><ul id="menu-footer-blog" class="menu"><li id="menu-item-26483" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-26483"><a href="https://blog.qualys.com/">All posts</a></li>
<li id="menu-item-26484" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26484"><a href="https://blog.qualys.com/laws-of-vulnerabilities">The Laws of Vulnerabilities</a></li>
<li id="menu-item-26485" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26485"><a href="https://blog.qualys.com/securitylabs">Security Labs</a></li>
<li id="menu-item-26486" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26486"><a href="https://blog.qualys.com/ssllabs">SSL Labs</a></li>
<li id="menu-item-26487" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26487"><a href="https://blog.qualys.com/technology">Qualys Technology</a></li>
<li id="menu-item-26488" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26488"><a href="https://blog.qualys.com/news">Qualys News</a></li>
</ul></div></section><section id="nav_menu-6" class="widget widget_nav_menu q-footer__group"><h3 class="widget-title q-footer__subheading">Training</h3><div class="menu-footer-training-container"><ul id="menu-footer-training" class="menu"><li id="menu-item-26526" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26526"><a href="https://www.qualys.com/training/">Overview</a></li>
<li id="menu-item-26527" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26527"><a href="https://www.qualys.com/training/#self-paced">Certified Courses</a></li>
<li id="menu-item-26528" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26528"><a href="https://www.qualys.com/training/#video-library">Video Library</a></li>
<li id="menu-item-26529" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26529"><a href="https://www.qualys.com/training/#instructor-led">Instructor-led Training</a></li>
</ul></div></section><section id="nav_menu-7" class="widget widget_nav_menu q-footer__group"><h3 class="widget-title q-footer__subheading">Docs</h3><div class="menu-footer-docs-container"><ul id="menu-footer-docs" class="menu"><li id="menu-item-26497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26497"><a href="https://www.qualys.com/documentation/">Overview</a></li>
<li id="menu-item-26498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26498"><a href="https://www.qualys.com/documentation/release-notes/">Release Notes</a></li>
</ul></div></section><section id="nav_menu-8" class="widget widget_nav_menu q-footer__group"><h3 class="widget-title q-footer__subheading">Support</h3><div class="menu-footer-support-container"><ul id="menu-footer-support" class="menu"><li id="menu-item-26525" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-26525"><a href="https://qualys-secure.force.com/customer/s/">Support Portal</a></li>
</ul></div></section>
			</div>

		</div>
		<div class="q-footer__row">

			<small class="q-footer__copyright">¬© 2021 Qualys, Inc. All rights reserved. <a href="https://www.qualys.com/company/privacy/"><span style="white-space: nowrap;">Privacy Policy</span></a></small>

		</div>
	</div>
</footer><!-- #colophon -->

<link rel='preload'   href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/plugins/shariff/css/shariff.min.css?ver=4.6.5' data-rocket-async="style" as="style" onload="this.onload=null;this.rel='stylesheet'" media='all' />
<script src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/plugins/progressive-wp/assets/scripts/clientjs.min.js?ver=1.0.0' id='clientjs-js'></script>
<script data-minify="1" src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/plugins/progressive-wp/assets/scripts/ui-pushbutton-98ba66dfd0341a8d80fc2e18bc981e2a.js' id='pwp-pushbutton-script-js'></script>
<script data-minify="1" src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/plugins/progressive-wp/assets/scripts/ui-installprompt-9392b96204a113a5908b38e96b4bf2a0.js' id='pwp-installprompt-script-js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery-migrate/3.3.0/jquery-migrate.min.js' id='jquery-migrate-js'></script>
<script id='qualys2020-script-js-extra'>
var qualys2020Script = {"ajaxurl":"https:\/\/blog.qualys.com\/wp-admin\/admin-ajax.php"};
</script>
<script data-minify="1" src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/themes/qualys2020/script/script-6b483fea4ba127d27c9f3e1b2a6fd101.js' id='qualys2020-script-js'></script>
<script src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=5.5.3' id='comment-reply-js'></script>
<script src='https://static.cloud.coveo.com/searchui/v2.9856/js/CoveoJsSearch.Lazy.min.js' id='coveo-script-js'></script>
<script data-minify="1" src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/themes/qualys2020/script/coveo-71c5075d56b57d65e29e0caa5855eade.js' id='q-script-coveo-js'></script>
<script src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/plugins/jetpack/vendor/automattic/jetpack-lazy-images/src/js/intersectionobserver-polyfill.min.js?ver=1.1.2' id='jetpack-lazy-images-polyfill-intersectionobserver-js'></script>
<script id='jetpack-lazy-images-js-extra'>
var jetpackLazyImagesL10n = {"loading_warning":"Images are still loading. Please cancel your print and try again."};
</script>
<script src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/plugins/jetpack/vendor/automattic/jetpack-lazy-images/src/js/lazy-images.min.js?ver=1.1.2' id='jetpack-lazy-images-js'></script>
<script src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=5.5.3' id='wp-embed-js'></script>
<script id='jetpack-carousel-js-extra'>
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/blog.qualys.com\/wp-admin\/admin-ajax.php","nonce":"86a68af556","display_exif":"0","display_comments":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/blog.qualys.com\/wp-login.php?redirect_to=https%3A%2F%2Fblog.qualys.com%2Fvulnerabilities-research%2F2021%2F01%2F26%2Fcve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"local_comments_commenting_as":"<fieldset><label for=\"email\">Email (Required)<\/label> <input type=\"text\" name=\"email\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-email-field\" \/><\/fieldset><fieldset><label for=\"author\">Name (Required)<\/label> <input type=\"text\" name=\"author\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-author-field\" \/><\/fieldset><fieldset><label for=\"url\">Website<\/label> <input type=\"text\" name=\"url\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-url-field\" \/><\/fieldset>"};
</script>
<script src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/plugins/jetpack/_inc/build/carousel/jetpack-carousel.min.js?ver=9.4' id='jetpack-carousel-js'></script>
<script data-minify="1" async="async" src='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/plugins/akismet/_inc/form-d78310fecfa3b2aea0c3488a008513d5.js' id='akismet-form-js'></script>
<script src='https://stats.wp.com/e-202107.js' defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.4',blog:'105655880',post:'27395',tz:'-8',srv:'blog.qualys.com'} ]);
	_stq.push([ 'clickTrackerInit', '105655880', '27395' ]);
</script>

<script>"use strict";var wprRemoveCPCSS=function wprRemoveCPCSS(){var elem;document.querySelector('link[data-rocket-async="style"][rel="preload"]')?setTimeout(wprRemoveCPCSS,200):(elem=document.getElementById("rocket-critical-css"))&&"remove"in elem&&elem.remove()};window.addEventListener?window.addEventListener("load",wprRemoveCPCSS):window.attachEvent&&window.attachEvent("onload",wprRemoveCPCSS);</script><noscript><link rel='stylesheet' id='wp-block-library-css'  href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-includes/css/dist/block-library/style.min.css?ver=5.5.3' media='all' /><link data-minify="1" rel='stylesheet' id='ajax-load-more-filters-css'  href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/plugins/ajax-load-more-filters/dist/css/styles-97153ac796d733e4a046254ad8a00073.css' media='all' /><link rel='stylesheet' id='ajax-load-more-css'  href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/plugins/ajax-load-more/core/dist/css/ajax-load-more.min.css?ver=5.5.3' media='all' /><link data-minify="1" rel='stylesheet' id='pwp-pushbutton-style-css'  href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/plugins/progressive-wp/assets/styles/ui-pushbutton-3fc78fcdb4089ce6e2c6d3df8fde3813.css' media='all' /><link data-minify="1" rel='stylesheet' id='community-shared-css'  href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/themes/qualys2020/style/shared-60718d88b10e4f3ce4fb7deefd7f9fa0.css' media='all' /><link data-minify="1" rel='stylesheet' id='community-shared-30em-css'  href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/themes/qualys2020/style/shared-min-30em-4b6edaa9ccd65f8f6f3fe4625134eefb.css' media='screen and (min-width: 30em)' /><link data-minify="1" rel='stylesheet' id='community-shared-60em-css'  href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/themes/qualys2020/style/shared-min-60em-e7f7c2aa75fa2713e852d371cd314885.css' media='screen and (min-width: 60em)' /><link data-minify="1" rel='stylesheet' id='qualys2020-style-css'  href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/themes/qualys2020/style-01aae4306ae3572dc3ef43c461d72821.css' media='all' /><link rel='stylesheet' id='coveo-css'  href='https://static.cloud.coveo.com/searchui/v2.9856/css/CoveoFullSearch.css?ver=5.5.3' media='all' /><link data-minify="1" rel='stylesheet' id='jetpack_css-css'  href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/cache/min/1/wp-content/plugins/jetpack/css/jetpack-e4000e16d6eed41b6ec39e8396515003.css' media='all' /><link rel='stylesheet' id='shariffcss-css'  href='https://2jws2s3y97dy39441y2lgm98-wpengine.netdna-ssl.com/wp-content/plugins/shariff/css/shariff.min.css?ver=4.6.5' media='all' /></noscript></body>
</html>

<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me -->